cmake_minimum_required(VERSION 2.6 FATAL_ERROR)
project(demo LANGUAGES C)

option(ENABLE_LIBJPEG "Enable JPEG library" ON)

if (NOT JASPER_INCLUDE_DIR)
	set(JASPER_INCLUDE_DIR "/tmp/jasper/install/include")
endif()
if (NOT JASPER_LIBRARIES)
	set(JASPER_LIBRARIES "-L/tmp/jasper/install/lib" "-ljasper")
endif()

find_package(JPEG)
if (JPEG_FOUND)
	include_directories("${JPEG_INCLUDE_DIR}")
endif()
check_include_files(jpeglib.h HAVE_JPEGLIB_H)
message("JPEG library found: ${JPEG_FOUND}")
message("JPEG libraries: ${JPEG_LIBRARIES}")
message("JPEG include directory: ${JPEG_INCLUDE_DIR}")
message("HAVE_JPEGLIB_H: ${HAVE_JPEGLIB_H}")
message("ENABLE_LIBJPEG: ${ENABLE_LIBJPEG}")
if(JPEG_FOUND AND (NOT ENABLE_LIBJPEG OR NOT HAVE_JPEGLIB_H))
	message("disabling LIBJPEG")
	set(JPEG_FOUND false)
	set(JPEG_LIBRARIES "")
	set(JPEG_INCLUDE_DIR "")
endif()

message("${JASPER_INCLUDE_DIR}")
message("${JASPER_LIBRARIES}")
include_directories(${JASPER_INCLUDE_DIR})
link_libraries(${JASPER_LIBRARIES} "-ljpeg" "-lm")
add_executable(jasper jasper.c)
